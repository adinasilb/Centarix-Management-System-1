@model PrototypeWithAuth.ViewModels.ConfirmEmailViewModel
@{
   

}

<div class="modal modal-view overflow-auto email-model" id="myModal" role="dialog" aria-labelledby="Request" data-backdrop="false">

    <div class="modal-dialog modal-lg" role="document" style="max-height:100%; max-width:60rem; ">

        <div class="modal-content d-inline-block" style="width:58.96rem;">

            <div class="modal-header pb-0 border-bottom-0">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <form action="" method="post" enctype="multipart/form-data" style="height: 100%; ">
                <input asp-for="VendorId" style="display: none;" />
                <input asp-for="RequestID" style="display: none;" />
                @Html.HiddenFor(model => model.IsSingleOrder)
                @*THE FOLLOWING HIDDEN VALUES ARE TO REMEMBER THE REQUESTS INDEX PAGE FROM BEFORE*@
                @*the values for the hidden data is set in js on the modal success area off of the tempdata*@
                @Html.HiddenFor(model => model.Page)
                @Html.HiddenFor(model => model.RequestStatusID)
                @Html.HiddenFor(model => model.SubCategoryID)
                @Html.HiddenFor(model => model.VendorID)
                @Html.HiddenFor(model => model.ApplicationUserID) @*MAKE SURE THIS IS DOING IT CORRECTLY --> make sure js is parsing it as a string*@
                @Html.HiddenFor(model => model.PageType) @*JS shoulde be taking this as a string *@


                @*<div class="modal-body">
            @if (IsBeingApproved == "True")
            {
                <h4>Would you like to approve this Request for @Model.Request.Product.ProductName ?</h4>
            }
        </div>*@

                @*<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">*@

                <div style="padding:1rem 2rem">
                    <header class="page-header">
                        <div class="row">
                            <div class="col-md-6 company-logo">
                                <br />
                                <img src="~/images/css/Centarix_Logo.png" width="400" alt="Centarix Logo">
                            </div>
                            <div class="col-md-3 offset-3 pt-3 company-info">
                                <span style="font-weight: 700; font-size:1.5rem;">Centarix Biotech</span><br>
                                <span>ID: 51565512</span><br>
                                <span>Hamarpeh 3, Jerusalem</span><br>
                                <span>Tel: 073-7896888</span>
                            </div>
                        </div>
                        <hr>
                    </header>
                    <div class="row">
                        <div class="col-6">
                            <span style="font-weight: 700; font-size:2rem;">Purchase Order: @Model.Requests.FirstOrDefault().ParentRequest.OrderNumber</span>
                        </div>
                        <div class="col-3 offset-3 text-center">
                            <span style="font-weight:500" id="date"></span>
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-4">
                            <div class="vendor-info">
                                <span style="font-weight: 700; font-size:1.5rem;">@Model.Requests.FirstOrDefault().Product.Vendor.VendorEnName</span><br>
                                <span>ID: @Model.Requests.FirstOrDefault().Product.Vendor.VendorBuisnessID</span><br>
                                <span>@Model.Requests.FirstOrDefault().Product.Vendor.VendorCity</span><br>
                                <span>Tel: @Model.Requests.FirstOrDefault().Product.Vendor.VendorTelephone</span>
                            </div>
                        </div>
                        <div class="col-6 offset-2">
                            <div class="note-message p-4 pl-5">
                                <span style="font-weight: 700; font-size:1.5rem;">Please Note</span><br>
                                <span>We need this order by next Sunday. Thank you!</span>
                            </div>
                        </div>
                    </div>
                    <br>
                    <div class="row">
                        <table class="table confirm-table">
                            <thead style="background-color: #D0001C; color: #ffffff;">
                                <tr>
                                    <th style="width:40%;">Items</th>
                                    <th style="width:20%;">SKU</th>
                                    <th style="width:10%;">Units</th>
                                    <th style="width:20%;">Price</th>
                                    <th style="width:10%;">Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                @for (int i = 0; i < Model.Requests.Count(); i++)
                                {

                                    <tr>
                                        <td style="font-weight: 500;">@Model.Requests[i].SubUnit @Model.Requests[i].Product.ProductName</td>
                                        <td>@Model.Requests[i].CatalogNumber</td>
                                        <td>@Model.Requests[i].Unit</td>
                                        @{double unitPrice = (Model.Requests[i].Cost) / (Model.Requests[i].Unit);}
                                        <td>@unitPrice.ToString("N2")</td>
                                        <td>@Model.Requests[i].Cost</td>
                                    </tr>


                                }
                                @{ double total = Model.Requests.Sum(r => r.Cost);
                                    double vat = total * .17;
                                    double totalWithVat = total + vat;}
                                <tr>
                                    <td colspan="3" rowspan="5" class="borderless-cell">
                                        <img src="~/images/css/centarix_logo_signature.png" alt="signature" width="250" class="mt-5">
                                    </td>
                                    <td>Total</td>
                                    <td>@total.ToString("N2")</td>
                                </tr>

                                <tr>
                                    <td>Discount @*@Html.DisplayFor(modelItem => Model.Request.)*@</td>
                                    @*@{double discount = Model.Request.Cost * Model.Request.Discount; }*@
                                    <td>@*discount*@</td>

                                </tr>
                                <tr>
                                    <td>Total Price</td>
                                    @*@{ double totalWithDis = Model.Request.Cost - discount}*@
                                    <td>@*@totalWithDis*@</td>
                                </tr>
                                <tr>
                                    <td>VAT [17%]</td>
                                    @* make the vat a global variable*@
                                    <td>@vat.ToString("N2")</td>
                                </tr>
                                <tr>
                                    <td style="font-weight: bold;">Total To Pay</td>

                                    <td style="font-weight: bold;">@totalWithVat.ToString("N2")</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <br>
                    <br>
                    <br>
                    <br>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="payment-terms">
                                <span style="font-weight:700; font-size:1.5rem;">Payment Terms</span><br>
                                <span class="payment-terms">@Model.Requests.FirstOrDefault().Terms</span>
                            </div>
                        </div>
                    </div>
                    <br />
                    <br />
                    <div class="modal-footer p-4" style="justify-content:space-evenly;">
                        <input type="submit" class="inv-button" asp-action="ConfirmEmailModal" value="Confirm & Send Email" />
                        <button class="cancel-button cancel-email" data-dismiss="modal">Cancel Email</button>@*FAIGE: should this delete the request?*@
                    </div>
                </div>

                <script>
                    var today = new Date();
                    var date = today.getDate() + '/' + (today.getMonth() + 1) + '/' + today.getFullYear();
                    document.getElementById("date").innerHTML = date;
                </script>


            </form>

        </div>
    </div>
</div>

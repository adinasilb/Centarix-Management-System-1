@using Microsoft.AspNetCore.Identity
@using PrototypeWithAuth.Data
@using PrototypeWithAuth.AppData
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@{
    
        //Layout = null;

        ///*
        // * Determine Active Nav Link START
        // * using the
        // */

        //initializing pageType to None just in case none is passed in we don't want to disable any buttons unnecessarily (can take this out in the future if we are sure that we don't need it)
        //var pageType = AppUtility.PaymentPageTypeEnum.None;

        //all pages need PageType passed in so we're testing if it's null and if not we're taking in the type
        //if (TempData["PageType"] != null)
        //{
        //    pageType = (AppUtility.PaymentPageTypeEnum)Enum.Parse(typeof(AppUtility.PaymentPageTypeEnum), TempData["PageType"].ToString());
        //}

        //passing the
        //string initalClasses = "nav-link";
        //string currentClasses = " text-dark activeNavLinkAcc";
        //string notificationsClass = initalClasses;
        //string generalClass = initalClasses;
        //string suppliersClass = initalClasses;
        //switch (pageType)
        //{
        //    case AppUtility.PaymentPageTypeEnum.Notifications:
        //        notificationsClass = initalClasses + currentClasses;
        //        break;
        //    case AppUtility.PaymentPageTypeEnum.General:
        //        generalClass = initalClasses + currentClasses;
        //        break;
        //    case AppUtility.PaymentPageTypeEnum.Suppliers:
        //        suppliersClass = initalClasses + currentClasses;
        //        break;
    }

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Centarix Management System</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" />
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow ourNavBar">
            @*<div class="container-fluid">*@
            <div class="container-fluid justify-content-start float-left d-inline-block" style="width:auto">
                <a class="nav-link text-dark" asp-area="" asp-controller="Home" asp-action="Index"><img src="~/images/css/Centarix_Logo_only.png" height="20" alt="Logo" /></a>
            </div>
            <div class="container-fluid">
                <ul class="navbar-nav flex-grow-1 dropdown-menu-md-left font-weight-bold">

                    <li class="nav-item ml-5">
                        @Html.ActionLink("Suppliers", "IndexForLabManage", "Vendors", new { @PageType = AppUtility.PaymentPageTypeEnum.Suppliers }, new { })
                    </li>
                    <li class="nav-item ml-5 ">
                        @Html.ActionLink("Locations", "Index", "Locations", new { @PageType = AppUtility.PaymentPageTypeEnum.Suppliers }, new { })
                    </li>
                    <li class="nav-item ml-5">
                        Equipment
                        @*@Html.ActionLink("Notifications", "Index", "ParentRequests", new { @PageType = AppUtility.PaymentPageTypeEnum.Notifications }, new { @class = notificationsClass })*@
                    </li>
                    <li class="nav-item ml-5">
                        @Html.ActionLink("Search", "Search", "Requests", new { @PageType = AppUtility.PaymentPageTypeEnum.General }, new {})
                    </li>
                </ul>
            </div>
            <div class="container-fluid justify-content-end">
                <div class="navbar-collapse collapse d-md-inline-flex flex-md-row-reverse">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link text-dark" asp-area="Identity" asp-page="/Account/Manage/Index" title="Manage"> @UserManager.GetUserAsync(User).Result.FirstName @UserManager.GetUserAsync(User).Result.LastName</a>
                        </li>
                        <li class="nav-item">
                            <form class="form-inline" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })">
                                <button type="submit" class="nav-link btn btn-link text-dark">Logout</button>
                            </form>
                        </li>
                    </ul>
                </div>
            </div>
            @*</div>*@
        </nav>
    </header>
    <div class="container-fluid">
        <main role="main" class="pb-3">
            @RenderBody()
        </main>

    </div>

    <!-- The Modal -->
    <div class="modal modal-view" id="myModal">
    </div>


    <footer class="border-top footer text-muted">
        <div class="container">
            &copy; 2020 - Centarix Management System - <a asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a>
        </div>
    </footer>
    <script src="~/js/site.js" asp-append-version="true">


    </script>
    @RenderSection("Scripts", required: false)
</body>
</html>
<script>
    $(".load-vendor-search").on("click", function (e) {
        e.preventDefault();
        e.stopPropagation();
        var $itemurl = "Search";
        $.fn.CallPage($itemurl);
        return false;
    });


    $.fn.CallPage = function ($itemurl, ) {
        console.log("in function");
        $.ajax({
            async: true,
            url: $itemurl,
            type: 'GET',
            cache: false,
            success: function (data) {
                console.log("success!");
                //replaces the modal-view class with the ModalView view
                $(".modal-view").html(data);
                //turn off data dismiss by clicking out of the box and by pressing esc
                $(".modal-view").modal({
                    backdrop: 'static',
                    keyboard: false
                });
                //shows the modal
                $(".modal").modal('show');
                //bootstrap dynamically adds a class of modal-backdrop which must be taken off to make it clickable
                $(".modal-backdrop").remove();
            }
        });
    }
</script>


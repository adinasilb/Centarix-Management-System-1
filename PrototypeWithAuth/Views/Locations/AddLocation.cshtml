@model PrototypeWithAuth.ViewModels.AddLocationViewModel
<script src="~/js/LocationType.js"></script>
<script src="~/js/site.js" asp-append-version="true"></script>
<div class="modal modal-view fader" id="myModal" role="dialog" aria-labelledby="Request" data-backdrop="false">
    <div class="modal-dialog  modal-dialog-scrollable modal-lg" role="document" style="max-height:100%; overflow-y:auto; max-width: 30rem;">
        <div class="modal-dialog  modal-dialog-scrollable modal-lg" role="document" style="max-height:100%; overflow-y:auto; max-width: 33rem;">
            @*<div class="spinner-border center" role="status"
                   style="display:none;">
                    <span class="sr-only">Loading...</span>
                </div>*@
            <div class="center" role="status" id="loading" style="display:none;">
                <img src="~/images/css/Loading/centarix_loading3.gif" />
            </div>
            <div class="modal-content d-inline-block p-2" style="width:32rem; border-radius:2rem;">
                <!--HERE!-->

                <form id="AddLocationForm" action="" method="post" enctype="multipart/form-data" style="height: 100%; overflow: auto;">

                    <div style="overflow: hidden;">
                        <div asp-validation-summary="ModelOnly" class="text-danger"></div>

                        <div class="no-modal-header">
                            @*<h4>ADD LOCATION MODAL</h4>*@
                            <button type="button" class="close m-2" data-dismiss="modal">&times;</button>
                        </div>

                        <div class="modal-body">

                            <div class="md-form">
                                <input asp-for="LocationInstance.LocationInstanceName" type="text" class="form-control-plaintext border-bottom" />
                                <label asp-for="LocationInstance.LocationInstanceName" class="control-label"> </label> @*"Name"*@

                            </div>
                            <div class="form-group">
                                @*<label asp-for="LocationTypesDepthOfZero" class="control-label">Type of storage</label>*@
                                <div class=" form-control-plaintext border-bottom p-0">
                                    <span class="choose"></span>
                                    <div class="dropdown">
                                        <div class="select">
                                            <span>Select Type:</span>
                                            <i class="fa fa-chevron-left"></i>
                                        </div>
                                        <input type="hidden" asp-for="LocationInstance.LocationTypeID">
                                        <ul class="locationinstance dropdown-menu">
                                            @foreach (var locationType in Model.LocationTypesDepthOfZero)
                                            {
                                                <li onclick="LoadSublocations(this.id)" id="@locationType.LocationTypeID">
                                                    @locationType.LocationTypeName
                                                </li>
                                            }
                                            @*<li onclick="LoadSublocations(100)" id="1">Male</li>
                                                <li onclick="LoadSublocations(200)" idid="2">Female</li>*@
                                        </ul>
                                    </div>
                                </div>
                                @*<input asp-for="LocationInstance.LocationTypeID" style="display: none;" />
                                    <div class="dropdown">
                                        <button class="form-control-plaintext border-bottom" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <span class="float-right">></span>
                                        </button>
                                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton" style="border:none;">
                                            <ul>
                                                @foreach (var locationType in Model.LocationTypesDepthOfZero)
                                                {
                                                    <li class="dropdown-item locationinstance-locationtypeid" value="@locationType.LocationTypeID">@locationType.LocationTypeName</li>
                                                }
                                            </ul>
                                        </div>
                                    </div>*@
                                @*@Html.DropDownListFor(m => m.LocationInstance.LocationTypeID,
                                    new SelectList(Model.LocationTypesDepthOfZero, "LocationTypeID", "LocationTypeName"),
                                    "Select Type", new { @class = "form-control-plaintext border-bottom selectpicker" })*@
                                <span asp-validation-for="LocationInstance.LocationTypeID" class="text-danger"></span>
                            </div>

                            <div class="col-md-12 divSublocations mx-0 px-0">
                            </div>
                            <br />
                            <input id="submitAddLocation" type="submit" value="SAVE" asp-action="AddLocation" class="lab-man-button open-loading mx-3" />@*style="margin-right:11rem;"*@
                            @*@if (@User.IsInRole("Admin") || @User.IsInRole("Manager"))
                                {
                                    <button class="btn btn-link load-add-location-type float-none" style="color: #2196F3;">[Add Location Type]</button>
                                }*@
                            <input type="button" value="CANCEL" data-dismiss="modal" class="cancel-button float-right mr-3 mb-3" />
                            <br />
                        </div>

                        <div class="modal-footer-no">



                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>


<script>

    function LoadSublocations(str) {
        //$("#loading-content").load("dataSearch.php?" + str, hideLoader);
        console.log("load sublocations, str: " + str);
        var id = parseInt(str);
        var myDiv = $(".divSublocations");
        //var selectedId = $(this).children("option:selected").val();
        //console.log("selectedId: " + selectedId);
        $.ajax({
            //IMPORTANT: ADD IN THE ID
            async: true,
            url: "/Locations/SubLocation/?ParentLocationTypeID=" + str + "",
            type: 'GET',
            cache: true,
            context: myDiv,
            success: function (result) {
                this.html(result);
                $('.mdb-select').materialSelect();
                //$(".mdb-select-empty").materialSelect();
            }
        });
    }
</script>